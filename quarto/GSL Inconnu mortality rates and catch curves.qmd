---
title: "GSL Inconnu mortality rates and catch curves"
author: "Chelsey Lumb"
date: "`r Sys.Date()`"
format: html
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)  # Do you need to add knitr to beginning of quarto file? It doesn't look like it from https://quarto.org/docs/tools/rstudio.html
```

```{r load packages, include=FALSE}
library(tidyverse) # {purrr} and {stringr} part of tidyverse
library(lubridate)
library(stringr)
library(janitor)
library(here)
library(readr)
library(fs)        # tools to work with file-systems, a bit like {here}
library(FSA)

library(ggplot2)
library(scales)    # for CG's histogram code for len freq, need function "percent_format" for y-axes
library(forcats)   # to work with factors, like re-ordering panes created facet_grid()
library(knitr)     # to use kable() function to format tables
library(gt)        # to format tables
library(viridis)   # colours better on plots for colour-blind people
library(patchwork) # to make combined plots, like LKTR age frequency
# library(quarto)    # to output to pdf ? Don't really need to output file or report for mort rate estimates
```

```{r}
#| label: load data
#| results: hide
#| echo: false
#| warning: false
#| message: false
#| include: false

## recommend using the comment-based syntax (#|) vs. chunk options on the first line (e.g. ```{r, echo = FALSE}) to make documents more portable and consistent across execution engines https://quarto.org/docs/tools/rstudio.html

inco <- read_csv(here("data", "gsl_inco_agefreq.csv"))

str(inco)

print(inco)
```

```{r}
#| label: explore data 
#| echo: false
#| warning: false
#| message: false


inco |>  
  group_by(year) |>
  summarize(agerng=max(age)-min(age)+1,
            agesobs=n()) 
```

```{r}
#| label: plot data by year 
#| echo: false
#| warning: false
#| message: false

inco |>   
  ggplot() +
  facet_wrap(~ year) +
  geom_point(aes(x = age, y = catch))
```


```{r}
#| label: data preparation 
#| echo: false
#| warning: false
#| message: false


# A catch curve plots log catch versus age, though in this case, because of the presence of zero catches for some ages, log catch plus 1 was used 
# from Derek H. Ogle. 2023, April 24. Working with Multiple Catch Curves. https://fishr-core-team.github.io/fishR//blog/posts/2023-4-24_Multiple_CatchCurves.


inco <- inco |>
  mutate(catch1=catch+1,
         logcatch1=log(catch1))
headtail(inco)

``` 


The `echo: false` option disables the printing of code (only output is displayed).
